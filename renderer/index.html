<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self'">
    <title>Chahua Code Animator</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <!-- Header -->
    <header class="app-header">
        <div class="header-content">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 32 32">
                    <rect width="32" height="32" rx="6" fill="url(#gradient)"/>
                    <path d="M8 16L14 10L20 16L14 22L8 16Z" fill="white" opacity="0.9"/>
                    <path d="M14 10L20 16L26 10" fill="none" stroke="white" stroke-width="2" opacity="0.7"/>
                    <defs>
                        <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" class="gradient-stop-1"/>
                            <stop offset="100%" class="gradient-stop-2"/>
                        </linearGradient>
                    </defs>
                </svg>
                <div class="logo-text">
                    <h1>Chahua Code Animator</h1>
                    <p>Professional Code Visualization Tool</p>
                </div>
            </div>
            <div class="header-actions">
                <button id="securityStatsBtn" class="btn-icon" title="Security Stats">
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M10 2L4 6V10C4 14 6 18 10 20C14 18 16 14 16 10V6L10 2Z"/>
                    </svg>
                </button>
                <button id="exportLogBtn" class="btn-icon" title="Export Security Log">
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 17V19C3 20.1 3.9 21 5 21H15C16.1 21 17 20.1 17 19V17M10 3V15M10 15L6 11M10 15L14 11"/>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebarPanel">
            <div class="sidebar-section">
                <h3>
                    <svg width="16" height="16" fill="currentColor">
                        <path d="M3 2a1 1 0 011-1h8a1 1 0 011 1v12a1 1 0 01-1 1H4a1 1 0 01-1-1V2zm2 1v10h6V3H5z"/>
                    </svg>
                    File Selection
                </h3>
                <div class="drop-zone" id="dropZone">
                    <svg width="64" height="64" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M16 8L16 24M8 16H24M32 16C32 24.837 24.837 32 16 32C7.163 32 0 24.837 0 16C0 7.163 7.163 0 16 0C24.837 0 32 7.163 32 16Z"/>
                    </svg>
                    <p class="drop-text">Drag & Drop Code File Here</p>
                    <p class="drop-subtext">or</p>
                    <button id="selectFileBtn" class="btn-primary">Browse Files</button>
                    <p class="workspace-hint"> Files must be in <code>workspace</code> folder</p>
                </div>
                
                <div id="fileInfo" class="file-info">
                    <div class="file-icon">
                        <svg width="32" height="32" fill="currentColor">
                            <path d="M6 2a2 2 0 00-2 2v24a2 2 0 002 2h20a2 2 0 002-2V10l-8-8H6zm14 2l6 6h-6V4zM8 16h16v2H8v-2zm0 4h16v2H8v-2zm0 4h10v2H8v-2z"/>
                        </svg>
                    </div>
                    <div class="file-details">
                        <p class="file-name" id="fileName">No file selected</p>
                        <p class="file-meta" id="fileMeta"></p>
                        <div class="file-security">
                            <span class="security-badge" id="securityBadge">
                                <svg width="12" height="12" fill="currentColor">
                                    <path d="M6 1L2 3V6C2 8.5 3.5 11 6 12C8.5 11 10 8.5 10 6V3L6 1Z"/>
                                </svg>
                                Verified
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sidebar-section">
                <h3>
                    <svg width="16" height="16" fill="currentColor">
                        <path d="M15.8 8.4l-1.2-1.6c-.4-.5-1-1-1.6-1.2l-1.2-.6V3.8c0-1-.8-1.8-1.8-1.8H6c-1 0-1.8.8-1.8 1.8V5l-1.2.6c-.6.2-1.2.7-1.6 1.2L.2 8.4c-.2.3-.2.7 0 1l1.2 1.6c.4.5 1 1 1.6 1.2l1.2.6v1.2c0 1 .8 1.8 1.8 1.8h4c1 0 1.8-.8 1.8-1.8v-1.2l1.2-.6c.6-.2 1.2-.7 1.6-1.2l1.2-1.6c.2-.3.2-.7 0-1zM8 11c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3z"/>
                    </svg>
                    Animation Style
                </h3>
                <div class="style-grid">
                    <!-- <button class="style-card active" data-style="rain">
                        <div class="style-icon">
                            <svg width="32" height="32" fill="currentColor">
                                <path d="M8 4c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm4 4c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm4 4c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm-8 0c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm4 4c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm4 4c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm-8 0c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm4 4c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2z"/>
                            </svg>
                        </div>
                        <div class="style-name">Rain Fall</div>
                        <div class="style-desc">Physics-based falling</div>
                    </button> -->
                    <button class="style-card active" data-style="typing">
                        <div class="style-icon">
                            <svg width="32" height="32" fill="currentColor">
                                <path d="M2 6h28v4H2V6zm0 8h28v4H2v-4zm0 8h18v4H2v-4z"/>
                            </svg>
                        </div>
                        <div class="style-name">Typing</div>
                        <div class="style-desc">Character by character</div>
                    </button>
                    <button class="style-card" data-style="presentation">
                        <div class="style-icon">
                            <svg width="32" height="32" fill="currentColor" viewBox="0 0 32 32">
                                <path d="M4 6a2 2 0 012-2h20a2 2 0 012 2v16a2 2 0 01-2 2h-6l2.4 4H18l-1.6-4h-0.8L14 28H9.6L12 24H6a2 2 0 01-2-2V6zm4 4h16v2H8v-2zm0 5h16v2H8v-2zm0 5h10v2H8v-2z"/>
                            </svg>
                        </div>
                        <div class="style-name">Presentation</div>
                        <div class="style-desc">Markdown slide deck</div>
                    </button>
                    <!-- <button class="style-card" data-style="wave">
                        <div class="style-icon">
                            <svg width="32" height="32" fill="currentColor">
                                <path d="M2 16c0-2 1-4 3-5s4-1 6 1 4 2 6 2 4 0 6-2 4-2 6-1 3 3 3 5-1 4-3 5-4 1-6-1-4-2-6-2-4 0-6 2-4 2-6 1-3-3-3-5z"/>
                            </svg>
                        </div>
                        <div class="style-name">Wave</div>
                        <div class="style-desc">Flowing animation</div>
                    </button>
                    <button class="style-card" data-style="particles">
                        <div class="style-icon">
                            <svg width="32" height="32" fill="currentColor">
                                <circle cx="8" cy="8" r="2"/>
                                <circle cx="16" cy="4" r="2"/>
                                <circle cx="24" cy="8" r="2"/>
                                <circle cx="28" cy="16" r="2"/>
                                <circle cx="24" cy="24" r="2"/>
                                <circle cx="16" cy="28" r="2"/>
                                <circle cx="8" cy="24" r="2"/>
                                <circle cx="4" cy="16" r="2"/>
                                <circle cx="16" cy="16" r="3"/>
                            </svg>
                        </div>
                        <div class="style-name">Particles</div>
                        <div class="style-desc">Scatter & gather</div>
                    </button> -->
                </div>
            </div>

            <div class="sidebar-section">
                <h3>
                    <svg width="16" height="16" fill="currentColor">
                        <path d="M8 1a7 7 0 100 14A7 7 0 008 1zm0 2a1 1 0 011 1v3.586l2.207 2.207a1 1 0 01-1.414 1.414L7 8.414V4a1 1 0 011-1z"/>
                    </svg>
                    Settings
                </h3>
                <div class="settings-group">
                    <label>
                        <span>Animation Speed</span>
                        <input type="range" id="speedSlider" min="0.5" max="3" step="0.1" value="1">
                        <span class="range-value" id="speedValue">1.0x</span>
                    </label>
                    
                    <label>
                        <span>Block Size</span>
                        <input type="range" id="blockSizeSlider" min="8" max="16" step="1" value="10">
                        <span class="range-value" id="blockSizeValue">10px</span>
                    </label>
                    
                    <label>
                        <span>Lines per Block</span>
                        <input type="range" id="linesSlider" min="10" max="50" step="5" value="24">
                        <span class="range-value" id="linesValue">24</span>
                    </label>

                    <label>
                        <span>Font Family</span>
                        <select id="fontFamilySelect">
                            <option value="consolas">Consolas</option>
                            <option value="fira">Fira Code</option>
                            <option value="jetbrains">JetBrains Mono</option>
                            <option value="cascadia">Cascadia Code</option>
                        </select>
                    </label>

                    <label>
                        <span>Wrap Width</span>
                        <input type="range" id="wrapWidthSlider" min="50" max="90" step="5" value="70">
                        <span class="range-value" id="wrapWidthValue">70vw</span>
                    </label>

                    <label>
                        <span>Bottom Padding</span>
                        <input type="range" id="paddingSlider" min="40" max="240" step="10" value="140">
                        <span class="range-value" id="paddingValue">140px</span>
                    </label>

                    <label>
                        <span>Cursor Blink Speed</span>
                        <input type="range" id="cursorSpeedSlider" min="0.4" max="1.8" step="0.1" value="0.8">
                        <span class="range-value" id="cursorSpeedValue">0.8s</span>
                    </label>

                    <label class="checkbox-label">
                        <input type="checkbox" id="syntaxHighlight" checked>
                        <span>Syntax Highlighting</span>
                    </label>

                    <label class="checkbox-label">
                        <input type="checkbox" id="showLineNumbers">
                        <span>Show Line Numbers</span>
                    </label>

                    <label class="checkbox-label">
                        <input type="checkbox" id="highlightCurrentLine" checked>
                        <span>Highlight Current Line</span>
                    </label>

                    <label class="checkbox-label">
                        <input type="checkbox" id="highContrast">
                        <span>High Contrast Background</span>
                    </label>

                    <label class="checkbox-label">
                        <input type="checkbox" id="autoLoop">
                        <span>Auto-loop Typing</span>
                    </label>

                    <label class="checkbox-label">
                        <input type="checkbox" id="startAssembled">
                        <span>Skip Typing (Start Assembled)</span>
                    </label>

                    <button id="resetSettingsBtn" class="btn-secondary">Reset Settings</button>
                </div>
            </div>
    </aside>

    <div class="sidebar-resizer" id="sidebarResizer" role="separator" aria-orientation="vertical" aria-label="Resize sidebar" aria-valuemin="260" aria-valuemax="560" aria-valuenow="380" tabindex="0"></div>

    <!-- Preview Area -->
    <section class="preview-area" id="previewArea">
            <div class="preview-header">
                <h2>Preview</h2>
                <div class="preview-actions">
                    <!-- Quick Preview removed per UX decision -->
                    <button id="playBtn" class="btn-success" disabled>
                        <svg width="16" height="16" fill="currentColor">
                            <polygon points="5,3 15,8 5,13"/>
                        </svg>
                        Play Animation
                    </button>
                </div>
            </div>

            <div class="preview-content" id="previewContent">
                <div class="preview-placeholder">
                    <svg width="120" height="120" fill="none" stroke="currentColor" stroke-width="2" opacity="0.3">
                        <rect x="10" y="10" width="100" height="100" rx="8"/>
                        <path d="M30 35 L50 55 L30 75"/>
                        <path d="M60 35 L80 35 M60 55 L90 55 M60 75 L70 75"/>
                    </svg>
                    <p>Select a code file to preview</p>
                    <p class="placeholder-hint">Supported: JS, TS, Python, Java, C++, and more...</p>
                </div>
            </div>

            <div class="preview-footer">
                <div class="preview-stats" id="previewStats">
                    <span> Ready</span>
                </div>
            </div>
        </section>
    </main>

    <!-- Security Stats Modal -->
    <div id="securityModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2> Security Statistics</h2>
                <button class="modal-close" id="closeSecurityModal" aria-label="Close security statistics modal"></button>
            </div>
            <div class="modal-body" id="securityStatsContent">
                <div class="stats-loading">Loading...</div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="scripts/presentation-utils.js"></script>
    <script src="scripts/main.js"></script>
</body>
</html>
